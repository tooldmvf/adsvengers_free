SELECT b.last_name, sum(amount_revenue_approved)-sum(amount_spent) as Profit
FROM public.user_totals_month a
INNER JOIN public.user_profiles b ON (B.fk_user_id = a.fk_user_id)
Where 1=1
and ({{!SelectUser.selectedOptionValue}} OR (text(a.fk_user_id) IN ({{"'" + SelectUser.selectedOptionValue + "'"}})))
and substring(financial_month,1,4) = '{{SelectYear.selectedOptionValue}}'
group by last_name 
HAVING (sum(amount_revenue_approved)-sum(amount_spent) <> 0)
order by 1